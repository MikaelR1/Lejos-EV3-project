var xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			document.getElementById("result").innerHTML = this.responseText;
		}
	};
	xmlhttp.open("POST", "/rest/testing/newrobotvalues", true);
	xmlhttp.setRequestHeader("Content-type", "application/json");
	xmlhttp.send(jsonRobot);
}
</script>

<script>
function readCurrentStats(){
	var xmlhttp=new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
	  if (this.readyState == 4 && this.status == 200) {
		  var jsonstats=this.responseText;
		  //Add JSON string as a content of element resultone
		  document.getElementById("stats").innerHTML = jsonstats;
		  //Parse json string to a Javascript object
		  var stats=JSON.parse(jsonstats);
		  //print stats by function printOneFish.
		  printCurrentStats(stats);
	  }
	};
	xmlhttp.open("GET", "/rest/testing/getlatestvalues", true);
	xmlhttp.send();	
}
function printCurrentStats(robot){
	var s = <table id="table1">;
	s += "<tr><th>Nopeus</th><th>Kiihdytys</th><th>Musta-arvo</th><th>Valkoinen-arvo</th></tr>";
	s += "<tr>";
	s += "<td>" + robot.speedmulti + "</td>";
	s += "<td>" + robot.acceleration + "</td>";
	s += "<td>" + robot.black_value + "</td>";
	s += "<td>" + robot.white_value + "</td>";
	s += "</tr>";
	s += "</table>";
	document.getElementById("stats").innerHTML=s;
}

</script>

<script>
function readDbSpeed(){
	var xmlhttp=new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
	  if (this.readyState == 4 && this.status == 200) {
		  var jsondb=this.responseText;
		  //Add JSON string as a content of element resultone
		  document.getElementById("dbspeed").innerHTML = jsondb;
		  //Parse json string to a Javascript object
		  var dbspeed=JSON.parse(jsondb);
		  //print stats 
		  printCurrentStats(dbspeed);
	  }
	};
	xmlhttp.open("GET", "/rest/testing/getdbspeed", true);
	xmlhttp.send();	
}
function printDbSpeed(speeddata){
	var t = <table id="table2">;
	t += "<tr><th>Vasemman moottorin nopeus</th><th>Oikean moottorin nopeus</th></tr>";
	t += "<tr>";
	t += "<td>" + speeddata.lcurrent_speed + "</td>";
	t += "<td>" + speeddata.rcurrent_speed + "</td>";
	t += "</tr>";
	t += "</table>";
	document.getElementById("dbspeed").innerHTML=t;
}

</script>

<body>
	<header id="heder">
		<div id=lego>
			<img id='logo'
				src='/assets/LEGO-Logo.png' alt= 'lego'
				width='150' height='70' style='float: left;'>
		</div>
		<h1>EV3 Lego Project -Team Databurst</h1>

	</header>
	<article id='artikkeli'>
		<section>
			<h2>Robotin kontrollipaneeli</h2>
			<form>
				<label for="Nopeus"><b>Nopeus:</b></label> <input id="nopeus"
					type='number' name='speedmulti' min="0" max="600" required><br>
				<br> <label for="Kiihdytys"><b>Kiihdytys:</b></label> <input
					type='number' name='acceleration' min="0" max="1000" required><br>
				<br> <label for="black_value"><b>Musta-arvo:</b></label> <input
					type="range" id="black_value" name="black_value" step="0.01"
					min="0" max="0.3">
				<output id="black_output"></output>
				<br>
				<br> <label for="white_value"><b>Valkoinen-arvo:</b></label> <input
					type="range" id="white_value" name="white_value" step="0.01"
					min="0.3" max="1">
				<output id="white_output"></output>
				<br> <br> <input type="button" name="ok"
					value="Lähetä uudet arvot robotille"
					onclick="sendRobot(this.form);">
			</form>

			<br>
			<br>
			<button onclick='readCurrentStats();'>Näytä tämänhetkiset
				arvot</button>
			<br> <br>
			<br>
			<div id='stats'></div>

			<script>
    const whiteValue = document.getElementById('white_value');
    const whiteOutput = document.getElementById('white_output');
    whiteOutput.textContent = whiteValue.value;
    whiteValue.addEventListener('input', () => {
      whiteOutput.textContent = whiteValue.value;
    });

    const blackValue = document.getElementById('black_value');
    const blackOutput = document.getElementById('black_output');
    blackOutput.textContent = blackValue.value;
    blackValue.addEventListener('input', () => {
      blackOutput.textContent = blackValue.value;
    });
  </script>

		</section>
	</article>

	<aside>
			<br>
			<button onclick='readDbSpeed();'>Näytä moottorien tämänhetkiset nopeudet</button>
			<br> <br>
			<div id='dbspeed'></div>
	</aside>
</body>
</html>
